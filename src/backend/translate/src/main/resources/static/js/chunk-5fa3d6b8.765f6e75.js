(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-5fa3d6b8"],{3235:function(t,e,o){"use strict";var n=o("ca7e"),s=o.n(n);s.a},3846:function(t,e,o){o("9e1e")&&"g"!=/./g.flags&&o("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:o("0bfb")})},"6b54":function(t,e,o){"use strict";o("3846");var n=o("cb7c"),s=o("0bfb"),a=o("9e1e"),i="toString",c=/./[i],r=function(t){o("2aba")(RegExp.prototype,i,t,!0)};o("79e5")(function(){return"/a/b"!=c.call({source:"a",flags:"b"})})?r(function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!a&&t instanceof RegExp?s.call(t):void 0)}):c.name!=i&&r(function(){return c.call(this)})},"6f2f":function(t,e,o){"use strict";var n=o("cc0d"),s=o.n(n);s.a},"86fa":function(t,e,o){"use strict";o.r(e);var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("div",{staticStyle:{"margin-bottom":"3px"}},[o("Row",[t.confirmed?o("label",{staticStyle:{"font-size":"20px"}},[t._v("正在服务用户 ")]):t._e(),t.confirmed?o("Button",{staticStyle:{float:"right"},attrs:{type:"warning"},on:{click:t.logout}},[t._v("结束服务")]):t._e()],1)],1),t.confirmed?t._e():o("div",[o("Row",{staticStyle:{"margin-top":"10px"},attrs:{gutter:20}},[o("i-col",{staticStyle:{"margin-bottom":"20px"},attrs:{md:24,lg:8}},[o("Card",{staticStyle:{width:"320px"}},[o("div",{staticStyle:{"text-align":"center"}},[o("Button",{attrs:{type:"primary",shape:"circle"},on:{click:t.checkJob}},[t._v("检查请求")])],1)])],1),o("i-col",{staticStyle:{"margin-bottom":"20px"},attrs:{md:24,lg:8}},[o("Card",{directives:[{name:"show",rawName:"v-show",value:t.get,expression:"get"}],staticStyle:{width:"320px"}},[o("div",{staticStyle:{"text-align":"center"}},[o("Button",{attrs:{type:"primary",shape:"circle"},on:{click:t.confirm}},[t._v("接单")])],1)]),o("Card",{directives:[{name:"show",rawName:"v-show",value:!t.get,expression:"!get"}],staticStyle:{width:"320px"}},[o("div",{staticStyle:{"text-align":"center"}},[o("Button",{attrs:{type:"primary",shape:"circle"}},[t._v("当前没有订单")])],1)])],1)],1)],1),t.confirmed?o("div",{staticStyle:{border:"Gainsboro 1px solid",background:"WhiteSmoke",padding:"4px"}},[o("div",[o("chatview",{ref:"chat_view",staticStyle:{margin:"2px"},attrs:{height:t.height}})],1),o("Input",{staticStyle:{margin:"2px",width:"95%",float:"right"},model:{value:t.message_content,callback:function(e){t.message_content=e},expression:"message_content"}},[o("Button",{attrs:{slot:"append"},on:{click:function(e){return t.sendSingleTo(t.toUser)}},slot:"append"},[t._v("发送")])],1)],1):t._e()])},s=[],a=(o("7f7f"),o("6b54"),function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticStyle:{margin:"2px",float:"top",width:"100%"}},[o("div",{ref:"chat_box",style:{background:"WhiteSmoke",overflow:"auto",height:t.height+"px"}},t._l(t.testList1,function(e,n){return o("Row",{key:n,staticStyle:{width:"100%","margin-top":"5px"}},[o("Col",{attrs:{span:"12"}},[1===e.mode?o("Avatar",{staticStyle:{float:"left",margin:"5px"},attrs:{size:"large",src:"https://i.loli.net/2017/08/21/599a521472424.jpg"}}):t._e(),1===e.mode&&1===e.type?o("Card",{staticStyle:{float:"left",margin:"5px","max-width":"80%","word-wrap":"break-word"}},[t._v("\n          "+t._s(e.text)+"\n        ")]):t._e(),1===e.mode&&2===e.type?o("Card",{staticStyle:{float:"left",margin:"5px","max-width":"80%","word-wrap":"break-word"}},[o("img",{staticStyle:{"max-width":"100%"},attrs:{src:e.text}})]):t._e(),1===e.mode&&3===e.type?o("Card",{staticStyle:{float:"left",margin:"5px","max-width":"80%","word-wrap":"break-word","border-radius":"10px"}},[o("audio",{attrs:{src:e.text,controls:"controls"}})]):t._e(),2===e.mode?o("label",{staticStyle:{width:"10px"}},[t._v("　")]):t._e()],1),o("Col",{attrs:{span:"12"}},[2===e.mode?o("Avatar",{staticStyle:{float:"right",margin:"5px"},attrs:{size:"large",src:"https://i.loli.net/2017/08/21/599a521472424.jpg"}}):t._e(),2===e.mode&&1===e.type?o("Card",{staticStyle:{float:"right",margin:"5px","max-width":"80%","word-wrap":"break-word"}},[t._v("\n          "+t._s(e.text)+"\n        ")]):t._e(),2===e.mode&&2===e.type?o("Card",{staticStyle:{float:"right",margin:"5px","max-width":"80%","word-wrap":"break-word"}},[o("img",{staticStyle:{"max-width":"100%"},attrs:{src:e.text}})]):t._e()],1)],1)}),1)])}),i=[],c=(o("c5f6"),{name:"chatview",props:{height:Number},data:function(){return{testList1:[],src:""}},methods:{addMessage:function(t,e,o,n){var s=this.$refs.chat_box;this.testList1.push({text:t,mode:e,type:o,extra:n||{}}),setTimeout(function(){s.scrollTop=s.scrollHeight},0)}}}),r=c,l=(o("3235"),o("2877")),g=Object(l["a"])(r,a,i,!1,null,"3a5cac1a",null),d=g.exports,m=o("bc3a"),u=o.n(m),f={name:"jmessage",components:{Chatview:d},data:function(){return{username:"未登录",message_content:"",toUser:"",confirmed:!1,height:document.body.clientHeight/1.5,id:"inputf",get:!1}},mounted:function(){if(this.initJmessage(),sessionStorage.getItem("confirmed"))var t=sessionStorage.getItem("confirmed");this.confirmed="false"!==t,console.log("confirm"),console.log(this.confirmed)},methods:{checkJob:function(){var t=this;u.a.get("http://202.120.40.8:30454/translate/translator/checkjob").then(function(e){console.log(e),t.get=e.data,console.log(t.get)})},initJmessage:function(){var t="6a8022404564c09c1622da33",e=(new Date).getTime().toString(),o="022cd9fd995849b58b3ef0e943421ed9",n="2361ed70808bbea38749f983",s=hex_md5("appkey="+t+"&timestamp="+e+"&random_str="+o+"&key="+n);window.JIM=new JMessage,JIM.init({appkey:t,random_str:o,signature:s,timestamp:e,flag:0}).onSuccess(function(t){console.log(t)}).onFail(function(t){console.log(t)}),JIM.onSyncConversation(function(t){console.log(t)})},login:function(){var t=sessionStorage.getItem("username"),e=sessionStorage.getItem("password"),o=this;console.log(t),console.log(e),JIM.login({username:t,password:e,is_md5:!0}).onSuccess(function(t){console.log(t),o.username=t.username,o.bindReceive();var e=sessionStorage.getItem("masterid");u.a.get("http://202.120.40.8:30454/translate/translator/getjob?translatorid="+e).then(function(t){console.log(t.data);var e=t.data.userId.toString();o.toUser=e+e+e+e,console.log("that.toUser"),console.log(o.toUser)})}).onFail(function(t){console.log("登陆失败"),console.log(t.code),880103===t.code&&o.signup()})},signup:function(){var t=sessionStorage.getItem("username"),e=sessionStorage.getItem("password"),o=this;console.log(t),console.log(e),JIM.register({username:t,password:e,is_md5:!0,extras:{key1:"val1",key2:"val2"},address:"上海"}).onSuccess(function(t){console.log("注册成功"),o.login()}).onFail(function(t){console.log("注册失败")})},getConversation:function(){JIM.getConversation().onSuccess(function(t){console.log(t)}).onFail(function(t){})},sendSingleTo:function(){console.log(this.username+" "+this.toUser),console.log(this.message_content);var t=this;JIM.sendSingleMsg({target_username:t.toUser,target_nickname:"",content:t.message_content,appkey:"6a8022404564c09c1622da33",extras:""}).onSuccess(function(e,o){console.log(e),console.log(o),t.$refs.chat_view.addMessage(o.content.msg_body.text,2,1),t.message_content=""}).onFail(function(t){console.log(t)})},bindReceive:function(){var t=this;JIM.onMsgReceive(function(e){if("image"===e.messages[0].content.msg_type)JIM.getResource({media_id:e.messages[0].content.msg_body.media_id}).onSuccess(function(e){console.log(e),t.$refs.chat_view.addMessage(e.url,1,2)}).onFail(function(t){});else if("voice"===e.messages[0].content.msg_type){var o=e.messages[0].content.msg_body.duration;JIM.getResource({media_id:e.messages[0].content.msg_body.media_id}).onSuccess(function(e){console.log(e),t.$refs.chat_view.addMessage(e.url,1,3,o)}).onFail(function(t){})}else t.$refs.chat_view.addMessage(e.messages[0].content.msg_body.text,1,1);console.log(e)})},logout:function(){console.log("logout"),JIM.loginOut(),this.username="未登录",this.initJmessage(),sessionStorage.setItem("confirmed","false"),this.confirmed=!1,console.log(this.confirmed),this.checkJob()},confirm:function(){this.login(),console.log(this.toUser),sessionStorage.setItem("confirmed","true"),this.confirmed=!0,console.log(this.confirmed)},imageInput:function(t){var e=this,o=new FormData,n=document.getElementById(this.id).files[0];console.log(n),o.append(n.name,n),JIM.sendSinglePic({target_username:e.toUser,target_nickname:"",image:o,appkey:"6a8022404564c09c1622da33",extras:{}}).onSuccess(function(t,o){console.log(t),JIM.getResource({media_id:o.content.msg_body.media_id}).onSuccess(function(t){console.log(t),e.$refs.chat_view.addMessage(t.url,2,2)}).onFail(function(t){})}).onFail(function(t){})}}},p=f,h=(o("6f2f"),Object(l["a"])(p,n,s,!1,null,"4fffd0eb",null));e["default"]=h.exports},ca7e:function(t,e,o){},cc0d:function(t,e,o){}}]);